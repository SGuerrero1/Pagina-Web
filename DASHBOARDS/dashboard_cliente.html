<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FoodApp - Panel de Cliente</title>
    <link rel="stylesheet" href="cliente.css">
    <link rel="icon" type="image/png" href="DASHBOARDS/IMAGENES RESTAURANTE/LOGO FOODAPP.png" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../styles/darkMode.css">
    <link rel="stylesheet" href="../styles/shared.css">
</head>
<body>
    <!-- Contenido del Dashboard (Cliente) -->
    <div class="dashboard client-dashboard" id="client-dashboard">
        <div class="toggle-container-dashboard">
            <label class="theme-switch">
                <input type="checkbox" id="themeToggle">
                <span class="slider">
                    <i class="fas fa-sun"></i>
                    <i class="fas fa-moon"></i>
                </span>
            </label>
            <button class="lang-btn" id="langToggle">ES</button>
        </div>
        <nav class="sidebar">
            <div class="logo">
                <img src="IMAGENES RESTAURANTE/LOGO FOODAPP.png" alt="FoodApp Logo" style="height:48px;object-fit:contain;">
                <h2>FoodApp</h2>
            </div>
            <ul class="menu">
                <li class="active"><a href="#"><i class="fas fa-home"></i> Inicio</a></li>
                <li><a href="#" class="feature-link"><i class="fas fa-hamburger"></i> Menú</a></li>
                <li><a href="#" class="feature-link"><i class="fas fa-map-marker-alt"></i> GPS</a></li>
                <li><a href="#" class="feature-link"><i class="fas fa-shopping-cart"></i> Carrito</a></li>
                <li><a href="#" class="feature-link"><i class="fas fa-history"></i> Historial</a></li>
                <li><a href="#" class="feature-link"><i class="fas fa-user"></i> Perfil</a></li>
                <li><a href="#" id="client-logout"><i class="fas fa-sign-out-alt"></i> Cerrar Sesión</a></li>
            </ul>
        </nav>
        <main class="content">
            <header>
                <h1>¡Bienvenido, Cliente!</h1>
                <div class="user-info">
                    <span>Cliente</span>
                    <!-- Aquí se insertará la imagen de perfil por JS si existe -->
                </div>
            </header>
            <!-- Descripción de la aplicación -->
            <section class="app-description" style="margin: 24px 0 18px 0; padding: 18px 22px; background: #fff7f0; border-radius: 10px; box-shadow: 0 2px 8px rgba(255,87,34,0.07);">
                <h2 style="color:#ff5722; margin-top:0;">¿Qué es FoodApp?</h2>
                <p style="font-size:1.08em; color:#444; margin-bottom:0;">FoodApp es una plataforma digital que conecta a clientes y restaurantes, permitiéndote explorar menús, buscar tus platos favoritos, realizar pedidos, gestionar tu perfil y mucho más, todo de forma rápida y sencilla.</p>
            </section>
            <div class="search-container">
                <div class="search-bar">
                    <input type="text" id="buscador-platos" placeholder="Buscar platos por nombre...">
                    <button><i class="fas fa-search"></i></button>
                </div>
            </div>
            <h2>Platos Recomendados</h2>
            <div class="food-grid" id="food-grid">
                <div id="search-error" style="margin-top: 15px; color: red; font-weight: bold;"></div>
                <!-- Los platos se cargarán dinámicamente aquí -->
            </div>
            <!-- Encuesta de satisfacción: se renderiza aquí por JS si hay pendiente -->
            <div id="encuesta-satisfaccion-cliente" style="margin-top:24px;"></div>
            <!-- Apartado de contacto -->
            <section class="contact-section" style="margin: 36px 0 0 0; padding: 18px 22px; background: #f0f7ff; border-radius: 10px; box-shadow: 0 2px 8px rgba(34,87,255,0.07);">
                <h2 style="color:#2257ff; margin-top:0;">Contacto</h2>
                <p style="font-size:1.08em; color:#333; margin-bottom:0;">
                    ¿Tienes dudas o necesitas ayuda? Contáctanos por WhatsApp:
                    <a href="https://wa.me/573203523841" target="_blank" style="color:#25d366; font-weight:bold; text-decoration:none; margin-left:8px;"><i class="fab fa-whatsapp"></i> 3203523841</a>
                </p>
            </section>
        </main>
        <footer style="text-align:center;margin:32px 0 12px 0;font-size:0.98em;color:#888;">
            <a href="../politicas_seguridad.html" style="color:#2257ff;text-decoration:underline;">Políticas de Seguridad</a>
        </footer>
    </div>
    <script src="cliente.js"></script>
    <script>
        // Buscador funcional: busca por nombre de plato creado
        const buscador = document.getElementById('buscador-platos');
        if (buscador) {
            buscador.addEventListener('input', function() {
                const query = buscador.value.trim().toLowerCase();
                // Obtiene todos los platos guardados
                const platos = JSON.parse(localStorage.getItem('platos')) || [];
                let resultados = [];
                if (query === '') {
                    resultados = platos;
                } else {
                    resultados = platos.filter(plato => plato.nombre && plato.nombre.toLowerCase().includes(query));
                }
                // Renderiza resultados en el grid
                const foodGrid = document.getElementById('food-grid');
                foodGrid.innerHTML = '';
                if (resultados.length === 0) {
                    foodGrid.innerHTML = '<div style="color:#888;margin:20px 0;">No hay platos disponibles.</div>';
                    return;
                }
                resultados.forEach(plato => {
                    const card = document.createElement('div');
                    card.className = 'food-card';
                    let tieneImagen = plato.img && plato.img.trim() !== '';
                    card.innerHTML = `
                        <div class="food-image">
                            ${tieneImagen ? `<img src="${plato.img}" alt="${plato.nombre}" onerror="this.parentNode.innerHTML='<div style=\'width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:#ccc;color:#555;font-weight:bold;font-size:1.1em;\'>Sin imagen</div>'">` : `<div style='width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:#ccc;color:#555;font-weight:bold;font-size:1.1em;'>Sin imagen</div>`}
                        </div>
                        <div class="food-info">
                            <h3>${plato.nombre}</h3>
                            <p>${plato.descripcion || ''}</p>
                            <div class="food-footer">
                                <span class="price">${plato.precio}</span>
                            </div>
                        </div>
                    `;
                    foodGrid.appendChild(card);
                });
            });
        }

        // Función para cerrar sesión
        const logoutButton = document.getElementById('client-logout');
        if (logoutButton) {
            logoutButton.addEventListener('click', function(e) {
                e.preventDefault();
                // Limpia datos de sesión
                localStorage.removeItem('rol');
                localStorage.removeItem('userRole');
                // Redirige al login
                window.location.href = '../index.html';
            });
        }

    </script>
    <div id="toggles-container"></div>
    <script src="../js/themeToggle.js"></script>
    <script>
        // Cargar el componente de toggles
        fetch('../components/toggles.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('toggles-container').innerHTML = html;
                // Inicializar el estado guardado
                const savedTheme = localStorage.getItem('theme');
                const savedLang = localStorage.getItem('language');
                if (savedTheme === 'dark') {
                    document.body.setAttribute('data-theme', 'dark');
                    document.getElementById('themeToggle').checked = true;
                }
                if (savedLang) {
                    document.querySelector('.lang-text').textContent = savedLang.toUpperCase();
                }
            });
    </script>
</body>
</html>